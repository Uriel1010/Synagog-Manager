{% extends "base.html" %}

{% block title %}Print Barcode Cards{% endblock %}

{% block head_extra %}
<style>
    .barcode-card {
        border: 1px solid #ccc;
        padding: 5px;       /* Less padding than before */
        margin: 5px;
        text-align: center;
        display: inline-block;
        width: 140px;       /* Make the card narrower */
        vertical-align: top;
        page-break-inside: avoid;
    }
    
    .barcode-label {
        font-size: 0.85em;  /* Shrink the text a bit */
        margin-bottom: 3px;
        word-wrap: break-word;
    }
    
    .barcode-card img {
        max-width: 100%;
        width: 200px; /* Increase the barcode width for low-quality printers */
        height: 40px; /* Keep the barcode height unchanged */
        margin-top: 3px;
        display: block;
        margin-left: auto;
        margin-right: auto;
    }
    
    .print-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: flex-start;
    }
    @media print {
        body * { visibility: hidden; }
        .print-area, .print-area * { visibility: visible; }
        .print-area { position: absolute; left: 0; top: 0; width: 100%; }
        .no-print { display: none; }
        .barcode-card { border: 1px solid #ddd; }
    }
</style>
{% endblock %}

{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom no-print">
    <h1 class="h2">Print Barcode Cards</h1>
    <div class="btn-toolbar mb-2 mb-md-0">
        <button onclick="window.print();" class="btn btn-sm btn-primary">Print This Page</button>
    </div>
</div>

<div class="no-print">
    <form method="POST" action="{{ url_for('admin.print_cards') }}" class="mb-4">
        <div class="mb-3">
            <label for="custom_prices" class="form-label">Custom Price Amounts (comma-separated)</label>
            <input type="text" class="form-control" id="custom_prices" name="custom_prices"
                   placeholder="e.g., 10,20,50" value="{{ default_prices }}">
        </div>
        <div class="mb-3">
            <label for="copies" class="form-label">Number of Copies per Amount</label>
            <input type="number" class="form-control" id="copies" name="copies" value="{{ copies }}">
        </div>
        <button type="submit" class="btn btn-primary">Generate Custom Price Cards</button>
    </form>
</div>

<p class="no-print">
    Use your browser's print function (Ctrl+P or Cmd+P) to print the generated cards. Adjust scale and margins as needed.
</p>

<div class="print-area">
    <div class="print-container">
        {% if cards %}
            {% for card in cards %}
                <div class="barcode-card">
                    <div class="barcode-label">{{ card.label }}</div>
                    {% if card.barcode_uri %}
                        <img src="{{ card.barcode_uri }}" alt="Barcode for {{ card.label }}">
                    {% else %}
                        <p class="text-danger small">Error generating barcode</p>
                    {% endif %}
                </div>
            {% endfor %}
        {% else %}
            <p>No cards available to display.</p>
        {% endif %}
    </div>
</div>
{% endblock %}
